(o=>{function r(t,a,e,i){return{css:{position:"absolute",top:t,left:a,overflow:i||"hidden","z-index":e||"auto"}}}function p(t,a,e,i,r){var s=1-r,n=s*s*s,o=r*r*r;return F(Math.round(n*t.x+3*r*s*s*a.x+3*r*r*s*e.x+o*i.x),Math.round(n*t.y+3*r*s*s*a.y+3*r*r*s*e.y+o*i.y))}function O(t,a,e){return n&&e?" translate3d("+t+"px,"+a+"px, 0px) ":" translate("+t+"px, "+a+"px) "}function j(t){return" rotate("+t+"deg) "}function s(t,a){return Object.prototype.hasOwnProperty.call(a,t)}function W(t,a,e,i,r){var s=[];if("-webkit-"==c){for(f=0;f<r;f++)s.push("color-stop("+i[f][0]+", "+i[f][1]+")");t.css({"background-image":"-webkit-gradient(linear, "+a.x+"% "+a.y+"%,  "+e.x+"% "+e.y+"%, "+s.join(",")+" )"})}else{a={x:a.x/100*t.width(),y:a.y/100*t.height()};for(var n=(e={x:e.x/100*t.width(),y:e.y/100*t.height()}).x-a.x,o=e.y-a.y,p=Math.atan2(o,n),h=p-Math.PI/2,l=Math.abs(t.width()*Math.sin(h))+Math.abs(t.height()*Math.cos(h)),g=Math.sqrt(o*o+n*n),h=F(e.x<a.x?t.width():0,e.y<a.y?t.height():0),o=Math.tan(p),n=-1/o,e=(n*h.x-h.y-o*a.x+a.y)/(n-o),o=e,e=n*e-n*h.x+h.y,d=Math.sqrt(Math.pow(o-a.x,2)+Math.pow(e-a.y,2)),f=0;f<r;f++)s.push(" "+i[f][1]+" "+100*(d+g*i[f][0])/l+"%");t.css({"background-image":c+"linear-gradient("+-p+"rad,"+s.join(",")+")"})}}function e(t,a,e){if(e[0]&&"object"!=typeof e[0]){if(a[e[0]]&&"_"!=e[0].toString().substr(0,1))return a[e[0]].apply(t,Array.prototype.slice.call(e,1));throw e[0]+" is an invalid value"}return a.init.apply(t,e)}var n,c="",z=Math.PI,k=z/2,h="ontouchstart"in window,l=h?{start:"touchstart",move:"touchmove",end:"touchend"}:{start:"mousedown",move:"mousemove",end:"mouseup"},g={backward:["bl","tl"],forward:["br","tr"],all:["tl","bl","tr","br"]},i=["single","double"],d={page:1,gradients:!0,duration:600,acceleration:!0,display:"double",when:null},f={folding:null,corners:"forward",cornerSize:100,gradients:!0,duration:600,acceleration:!0},u={0:{top:0,right:0,left:"auto",bottom:"auto"},1:{top:0,left:0,right:"auto",bottom:"auto"}},F=function(t,a){return{x:t,y:a}},v={init:function(t){void 0===n&&(n="WebKitCSSMatrix"in window||"MozPerspective"in document.body.style,c=(()=>{for(var t=["Moz","Webkit","Khtml","O","ms"],a=t.length,e="";a--;)t[a]+"Transform"in document.body.style&&(e="-"+t[a].toLowerCase()+"-");return e})());var a,e=this.data(),i=this.children();if(t=o.extend({width:this.width(),height:this.height()},d,t),e.opts=t,e.pageObjs={},e.pages={},e.pageWrap={},e.pagePlace={},e.pageMv=[],e.totalPages=t.pages||0,t.when)for(a in t.when)s(a,t.when)&&this.bind(a,t.when[a]);for(this.css({position:"relative",width:t.width,height:t.height}),this.turn("display",t.display),n&&!h&&t.acceleration&&this.transform(O(0,0,!0)),a=0;a<i.length;a++)this.turn("addPage",i[a],a+1);return this.turn("page",t.page),g=o.extend({},g,t.corners),o(this).bind(l.start,function(t){for(var a in e.pages)if(s(a,e.pages)&&!1===D._eventStart.call(e.pages[a],t))return!1}),o(document).bind(l.move,function(t){for(var a in e.pages)s(a,e.pages)&&D._eventMove.call(e.pages[a],t)}).bind(l.end,function(t){for(var a in e.pages)s(a,e.pages)&&D._eventEnd.call(e.pages[a],t)}),e.done=!0,this},addPage:function(t,a){var e=!1,i=this.data(),r=i.totalPages+1;if(a){if(a==r)a=r,e=!0;else if(r<a)throw new Error('It is impossible to add the page "'+a+'", the maximum value is: "'+r+'"')}else a=r,e=!0;return 1<=a&&a<=r&&(i.done&&this.turn("stop"),a in i.pageObjs&&v._movePages.call(this,a,1),e&&(i.totalPages=r),i.pageObjs[a]=o(t).addClass("turn-page p"+a),v._addPage.call(this,a),i.done&&this.turn("update"),v._removeFromDOM.call(this)),this},_addPage:function(t){var a,e,i=this.data(),r=i.pageObjs[t];r&&(v._necessPage.call(this,t)?(i.pageWrap[t]||(a="double"==i.display?this.width()/2:this.width(),e=this.height(),r.css({width:a,height:e}),i.pagePlace[t]=t,i.pageWrap[t]=o("<div/>",{class:"turn-page-wrapper",page:t,css:{position:"absolute",overflow:"hidden",width:a,height:e}}).css(u["double"==i.display?t%2:0]),this.append(i.pageWrap[t]),i.pageWrap[t].prepend(i.pageObjs[t])),t&&1!=v._setPageLoc.call(this,t)||v._makeFlip.call(this,t)):(i.pagePlace[t]=0,i.pageObjs[t]&&i.pageObjs[t].remove()))},hasPage:function(t){return t in this.data().pageObjs},_makeFlip:function(t){var a,e,i=this.data();return i.pages[t]||i.pagePlace[t]!=t||(a="single"==i.display,e=t%2,i.pages[t]=i.pageObjs[t].css({width:a?this.width():this.width()/2,height:this.height()}).flip({page:t,next:(!a||t!==i.totalPages)&&(e||a)?t+1:t-1,turn:this,duration:i.opts.duration,acceleration:i.opts.acceleration,corners:a?"all":e?"forward":"backward",backGradient:i.opts.gradients,frontGradient:i.opts.gradients}).flip("disable",i.disabled).bind("pressed",v._pressed).bind("released",v._released).bind("start",v._start).bind("end",v._end).bind("flip",v._flip)),i.pages[t]},_makeRange:function(){this.data();for(var t=this.turn("range"),a=t[0];a<=t[1];a++)v._addPage.call(this,a)},range:function(t){var a,e,i=this.data(),r=(t=t||i.tpage||i.page,v._view.call(this,t));if(t<1||t>i.totalPages)throw new Error('"'+t+'" is not a page for range');return r[1]=r[1]||r[0],1<=r[0]&&r[1]<=i.totalPages?(t=Math.floor(2),i.totalPages-r[1]>r[0]?e=2*t-(a=Math.min(r[0]-1,t)):a=2*t-(e=Math.min(i.totalPages-r[1],t))):e=a=5,[Math.max(1,r[0]-a),Math.min(i.totalPages,r[1]+e)]},_necessPage:function(t){var a;return 0===t||t>=(a=this.turn("range"))[0]&&t<=a[1]},_removeFromDOM:function(){var t,a=this.data();for(t in a.pageWrap)s(t,a.pageWrap)&&!v._necessPage.call(this,t)&&v._removePageFromDOM.call(this,t)},_removePageFromDOM:function(t){var a,e=this.data();e.pages[t]&&((a=e.pages[t].data()).f&&a.f.fwrapper&&a.f.fwrapper.remove(),e.pages[t].remove(),delete e.pages[t]),e.pageObjs[t]&&e.pageObjs[t].remove(),e.pageWrap[t]&&(e.pageWrap[t].remove(),delete e.pageWrap[t]),delete e.pagePlace[t]},removePage:function(t){var a=this.data();return a.pageObjs[t]&&(this.turn("stop"),v._removePageFromDOM.call(this,t),delete a.pageObjs[t],v._movePages.call(this,t,-1),a.totalPages=a.totalPages-1,v._makeRange.call(this),a.page>a.totalPages)&&this.turn("page",a.totalPages),this},_movePages:function(t,i){function a(t){var a=t+i,e=a%2;r.pageObjs[t]&&(r.pageObjs[a]=r.pageObjs[t].removeClass("page"+t).addClass("page"+a)),r.pagePlace[t]&&r.pageWrap[t]&&(r.pagePlace[a]=a,r.pageWrap[a]=r.pageWrap[t].css(u[s?0:e]).attr("page",a),r.pages[t]&&(r.pages[a]=r.pages[t].flip("options",{page:a,next:s||e?a+1:a-1,corners:s?"all":e?"forward":"backward"})),i)&&(delete r.pages[t],delete r.pagePlace[t],delete r.pageObjs[t],delete r.pageWrap[t],delete r.pageObjs[t])}var e,r=this.data(),s="single"==r.display;if(0<i)for(e=r.totalPages;t<=e;e--)a(e);else for(e=t;e<=r.totalPages;e++)a(e)},display:function(t){var a=this.data(),e=a.display;if(t){if(-1==o.inArray(t,i))throw new Error('"'+t+'" is not a value for display');return"single"==t?a.pageObjs[0]||(this.turn("stop").css({overflow:"hidden"}),a.pageObjs[0]=o("<div />",{class:"turn-page p-temporal"}).css({width:this.width(),height:this.height()}).appendTo(this)):a.pageObjs[0]&&(this.turn("stop").css({overflow:""}),a.pageObjs[0].remove(),delete a.pageObjs[0]),a.display=t,e&&(a=this.turn("size"),v._movePages.call(this,1,0),this.turn("size",a.width,a.height).turn("update")),this}return e},animating:function(){return 0<this.data().pageMv.length},disable:function(t){var a,e=this.data(),i=this.turn("view");for(a in e.disabled=void 0===t||!0===t,e.pages)s(a,e.pages)&&e.pages[a].flip("disable",!!t&&o.inArray(a,i));return this},size:function(t,a){if(t&&a){var e,i=this.data(),r="double"==i.display?t/2:t;for(e in this.css({width:t,height:a}),i.pageObjs[0]&&i.pageObjs[0].css({width:r,height:a}),i.pageWrap)s(e,i.pageWrap)&&(i.pageObjs[e].css({width:r,height:a}),i.pageWrap[e].css({width:r,height:a}),i.pages[e])&&i.pages[e].css({width:r,height:a});return this.turn("resize"),this}return{width:this.width(),height:this.height()}},resize:function(){var t,a=this.data();for(a.pages[0]&&(a.pageWrap[0].css({left:-this.width()}),a.pages[0].flip("resize",!0)),t=1;t<=a.totalPages;t++)a.pages[t]&&a.pages[t].flip("resize",!0)},_removeMv:function(t){for(var a=this.data(),e=0;e<a.pageMv.length;e++)if(a.pageMv[e]==t)return a.pageMv.splice(e,1),!0;return!1},_addMv:function(t){var a=this.data();v._removeMv.call(this,t),a.pageMv.push(t)},_view:function(t){var a=this.data();return t=t||a.page,"double"==a.display?t%2?[t-1,t]:[t,t+1]:[t]},view:function(t){var a=this.data(),t=v._view.call(this,t);return"double"==a.display?[0<t[0]?t[0]:0,t[1]<=a.totalPages?t[1]:0]:[0<t[0]&&t[0]<=a.totalPages?t[0]:0]},stop:function(t){var a,e,i=this.data(),r=i.pageMv;for(a in i.pageMv=[],i.tpage&&(i.page=i.tpage,delete i.tpage),r)s(a,r)&&(e=i.pages[r[a]].data().f.opts,D._moveFoldingPage.call(i.pages[r[a]],null),i.pages[r[a]].flip("hideFoldedPage"),i.pagePlace[e.next]=e.next,e.force)&&(e.next=e.page%2==0?e.page-1:e.page+1,delete e.force);return this.turn("update"),this},pages:function(t){var a=this.data();if(t){if(t<a.totalPages){for(var e=t+1;e<=a.totalPages;e++)this.turn("removePage",e);this.turn("page")>t&&this.turn("page",t)}return a.totalPages=t,this}return a.totalPages},_fitPage:function(t,a){var e=this.data(),i=this.turn("view",t);e.page!=t&&(this.trigger("turning",[t,i]),-1!=o.inArray(1,i)&&this.trigger("first"),-1!=o.inArray(e.totalPages,i))&&this.trigger("last"),e.pageObjs[t]&&(e.tpage=t,this.turn("stop",a),v._removeFromDOM.call(this),v._makeRange.call(this),this.trigger("turned",[t,i]))},_turnPage:function(t){var a,e,i=this.data(),r=this.turn("view"),s=this.turn("view",t);i.page!=t&&(this.trigger("turning",[t,s]),-1!=o.inArray(1,s)&&this.trigger("first"),-1!=o.inArray(i.totalPages,s))&&this.trigger("last"),i.pageObjs[t]&&(i.tpage=t,this.turn("stop"),v._makeRange.call(this),"single"==i.display?(a=r[0],e=s[0]):r[1]&&t>r[1]?(a=r[1],e=s[0]):r[0]&&t<r[0]&&(a=r[0],e=s[1]),i.pages[a])&&(t=i.pages[a].data().f.opts,i.tpage=e,t.next!=e&&(t.next=e,i.pagePlace[e]=t.page,t.force=!0),"single"==i.display?i.pages[a].flip("turnPage",s[0]>r[0]?"br":"bl"):i.pages[a].flip("turnPage"))},page:function(t){t=parseInt(t,10);var a=this.data();return 0<t&&t<=a.totalPages?((a.done&&-1==o.inArray(t,this.turn("view"))?v._turnPage:v._fitPage).call(this,t),this):a.page},next:function(){var t=this.data();return this.turn("page",v._view.call(this,t.page).pop()+1)},previous:function(){var t=this.data();return this.turn("page",v._view.call(this,t.page).shift()-1)},_addMotionPage:function(){var t=o(this).data().f.opts,a=t.turn,e=a.data();t.pageMv=t.page,v._addMv.call(a,t.pageMv),e.pagePlace[t.next]=t.page,a.turn("update")},_start:function(t,a,e){var i=a.turn.data(),r=o.Event("start");t.stopPropagation(),a.turn.trigger(r,[a,e]),r.isDefaultPrevented()?t.preventDefault():("single"==i.display&&(r="l"==e.charAt(1),1==a.page&&r||a.page==i.totalPages&&!r?t.preventDefault():r?(a.next=a.next<a.page?a.next:a.page-1,a.force=!0):a.next=a.page<a.next?a.next:a.page+1),v._addMotionPage.call(this))},_end:function(t,a){var e=o(this).data().f.opts,i=e.turn,r=i.data();t.stopPropagation(),a||r.tpage?r.tpage!=e.next&&r.tpage!=e.page||(delete r.tpage,v._fitPage.call(i,r.tpage||e.next,!0)):(v._removeMv.call(i,e.pageMv),i.turn("update"))},_pressed:function(){var t,a=o(this).data().f,e=a.opts.turn.data().pages;for(t in e)t!=a.opts.page&&e[t].flip("disable",!0);return a.time=(new Date).getTime()},_released:function(t,a){var e=o(this),i=e.data().f;t.stopPropagation(),((new Date).getTime()-i.time<200||a.x<0||a.x>o(this).width())&&(t.preventDefault(),i.opts.turn.data().tpage=i.opts.next,i.opts.turn.turn("update"),o(e).flip("turnPage"))},_flip:function(){var t=o(this).data().f.opts;t.turn.trigger("turn",[t.next])},calculateZ:function(t){for(var a,e,i,r=this,s=this.data(),n=this.turn("view"),o=n[0]||n[1],p={pageZ:{},partZ:{},pageV:{}},h=function(t){t=r.turn("view",t);t[0]&&(p.pageV[t[0]]=!0),t[1]&&(p.pageV[t[1]]=!0)},l=0;l<t.length;l++)i=s.pages[a=t[l]].data().f.opts.next,e=s.pagePlace[a],h(a),h(i),i=s.pagePlace[i]==i?i:a,p.pageZ[i]=s.totalPages-Math.abs(o-i),p.partZ[e]=2*s.totalPages+Math.abs(o-i);return p},update:function(){var t,a,e=this.data();if(e.pageMv.length&&0!==e.pageMv[0]){var i=this.turn("calculateZ",e.pageMv),r=this.turn("view",e.tpage);for(t in e.pagePlace[r[0]]==r[0]?r[0]:e.pagePlace[r[1]]==r[1]&&r[1],e.pageWrap)s(t,e.pageWrap)&&(e.pageWrap[t].css({display:i.pageV[t]?"":"none","z-index":i.pageZ[t]||0}),e.pages[t])&&(e.pages[t].flip("z",i.partZ[t]||null),i.pageV[t]&&e.pages[t].flip("resize"),e.tpage)&&e.pages[t].flip("disable",!0)}else for(t in e.pageWrap)s(t,e.pageWrap)&&(a=v._setPageLoc.call(this,t),e.pages[t])&&e.pages[t].flip("disable",e.disabled||1!=a).flip("z",null)},_setPageLoc:function(t){var a=this.data(),e=this.turn("view");return t==e[0]||t==e[1]?(a.pageWrap[t].css({"z-index":a.totalPages,display:""}),1):"single"==a.display&&t==e[0]+1||"double"==a.display&&t==e[0]-2||t==e[1]+2?(a.pageWrap[t].css({"z-index":a.totalPages-1,display:""}),2):(a.pageWrap[t].css({"z-index":0,display:"none"}),0)}},D={init:function(t){return t.gradients&&(t.frontGradient=!0,t.backGradient=!0),this.data({f:{}}),this.flip("options",t),D._addPageWrapper.call(this),this},setData:function(t){var a=this.data();return a.f=o.extend(a.f,t),this},options:function(t){var a=this.data().f;return t?(D.setData.call(this,{opts:o.extend({},a.opts||f,t)}),this):a.opts},z:function(t){var a=this.data().f;return a.opts["z-index"]=t,a.fwrapper.css({"z-index":t||parseInt(a.parent.css("z-index"),10)||0}),this},_cAllowed:function(){return g[this.data().f.opts.corners]||this.data().f.opts.corners},_cornerActivated:function(t){if(void 0===t.originalEvent)return!1;t=h?t.originalEvent.touches:[t];var a=this.data().f,e=a.parent.offset(),i=this.width(),r=this.height(),t={x:Math.max(0,t[0].pageX-e.left),y:Math.max(0,t[0].pageY-e.top)},e=a.opts.cornerSize,a=D._cAllowed.call(this);if(t.x<=0||t.y<=0||i<=t.x||r<=t.y)return!1;if(t.y<e)t.corner="t";else{if(!(r-e<=t.y))return!1;t.corner="b"}if(t.x<=e)t.corner+="l";else{if(!(i-e<=t.x))return!1;t.corner+="r"}return-1!=o.inArray(t.corner,a)&&t},_c:function(t,a){return{tl:F(a=a||0,a),tr:F(this.width()-a,a),bl:F(a,this.height()-a),br:F(this.width()-a,this.height()-a)}[t]},_c2:function(t){return{tl:F(2*this.width(),0),tr:F(-this.width(),0),bl:F(2*this.width(),this.height()),br:F(-this.width(),this.height())}[t]},_foldingPage:function(t){var a,e=this.data().f.opts;return e.folding||(e.turn?"single"==(a=e.turn.data()).display?a.pageObjs[e.next]?a.pageObjs[0]:null:a.pageObjs[e.next]:void 0)},_backGradient:function(){var t=this.data().f,a=t.opts.turn,a=t.opts.backGradient&&(!a||"single"==a.data().display||2!=t.opts.page&&t.opts.page!=a.data().totalPages-1);return a&&!t.bshadow&&(t.bshadow=o("<div/>",r(0,0,1)).css({position:"",width:this.width(),height:this.height()}).appendTo(t.parent)),a},resize:function(t){var a=this.data().f,e=this.width(),i=this.height(),r=Math.round(Math.sqrt(Math.pow(e,2)+Math.pow(i,2)));t&&(a.wrapper.css({width:r,height:r}),a.fwrapper.css({width:r,height:r}).children(":first-child").css({width:e,height:i}),a.fpage.css({width:i,height:e}),a.opts.frontGradient&&a.ashadow.css({width:i,height:e}),D._backGradient.call(this))&&a.bshadow.css({width:e,height:i}),a.parent.is(":visible")&&(a.fwrapper.css({top:a.parent.offset().top,left:a.parent.offset().left}),a.opts.turn)&&a.fparent.css({top:-a.opts.turn.offset().top,left:-a.opts.turn.offset().left}),this.flip("z",a.opts["z-index"])},_addPageWrapper:function(){var t,a,e=this.data().f,i=this.parent();e.wrapper||(this.css("left"),this.css("top"),a=this.width(),t=this.height(),Math.round(Math.sqrt(Math.pow(a,2)+Math.pow(t,2))),e.parent=i,e.fparent=e.opts.turn?e.opts.turn.data().fparent:o("#turn-fwrappers"),e.fparent||((a=o("<div/>",{css:{"pointer-events":"none"}}).hide()).data().flips=0,e.opts.turn?(a.css(r(-e.opts.turn.offset().top,-e.opts.turn.offset().left,"auto","visible").css).appendTo(e.opts.turn),e.opts.turn.data().fparent=a):a.css(r(0,0,"auto","visible").css).attr("id","turn-fwrappers").appendTo(o("body")),e.fparent=a),this.css({position:"absolute",top:0,left:0,bottom:"auto",right:"auto"}),e.wrapper=o("<div/>",r(0,0,this.css("z-index"))).appendTo(i).prepend(this),e.fwrapper=o("<div/>",r(i.offset().top,i.offset().left)).hide().appendTo(e.fparent),e.fpage=o("<div/>",{css:{cursor:"default"}}).appendTo(o("<div/>",r(0,0,0,"visible")).appendTo(e.fwrapper)),e.opts.frontGradient&&(e.ashadow=o("<div/>",r(0,0,1)).appendTo(e.fpage)),D.setData.call(this,e),D.resize.call(this,!0))},_fold:function(r){function t(t,a,e,i){var r=["0","auto"],s=(v-m)*e[0]/100,n=(w-m)*e[1]/100,r={left:r[a[0]],top:r[a[1]],right:r[a[2]],bottom:r[a[3]]},a=90!=i&&-90!=i?M?-1:1:0;e=e[0]+"% "+e[1]+"%",g.css(r).transform(j(i)+O(t.x+a,t.y,x),e),b.fpage.parent().css(r),b.wrapper.transform(O(-t.x+s-a,n-t.y,x)+j(-i),e),b.fwrapper.transform(O(-t.x+f.x+s,-t.y+f.y+n,x)+j(-i),e),b.fpage.parent().transform(j(i)+O(t.x+c.x-f.x,t.y+c.y-f.y,x),e),b.opts.frontGradient&&W(b.ashadow,F(M?100:0,P?100:0),F(o.x,o.y),[[h,"rgba(0,0,0,0)"],[.8*(1-h)+h,"rgba(0,0,0,"+.2*l+")"],[1,"rgba(255,255,255,"+.2*l+")"]],3),D._backGradient.call(g)&&W(b.bshadow,F(M?0:100,P?0:100),F(p.x,p.y),[[.8,"rgba(0,0,0,0)"],[1,"rgba(0,0,0,"+.3*l+")"],[1,"rgba(0,0,0,0)"]],3)}var o,p,h,s,l,g=this,n=0,d=0,f=F(0,0),c=F(0,0),u=F(0,0),v=this.width(),w=this.height(),a=D._foldingPage.call(this),b=(Math.tan(d),this.data().f),x=b.opts.acceleration,m=b.wrapper.height(),y=D._c.call(this,r.corner),P="t"==r.corner.substr(0,1),M="l"==r.corner.substr(1,1),_=function(){var t=F(y.x?y.x-r.x:r.x,y.y?y.y-r.y:r.y),a=Math.atan2(t.y,t.x),e=(n=(d=k-a)/z*180,i=F(M?v-t.x/2:r.x+t.x/2,t.y/2),d-Math.atan2(i.y,i.x)),e=Math.max(0,Math.sin(e)*Math.sqrt(Math.pow(i.x,2)+Math.pow(i.y,2)));if(u=F(e*Math.sin(d),e*Math.cos(d)),k<d&&(u.x=u.x+Math.abs(u.y*Math.tan(a)),u.y=0,Math.round(u.x*Math.tan(z-d))<w))return r.y=Math.sqrt(Math.pow(w,2)+2*i.x*t.x),P&&(r.y=w-r.y),_();k<d&&(e=z-d,a=m-w/Math.sin(e),f=F(Math.round(a*Math.cos(e)),Math.round(a*Math.sin(e))),M&&(f.x=-f.x),P)&&(f.y=-f.y),s=Math.round(u.y/Math.tan(d)+u.x);var i=v-s,t=i*Math.cos(2*d),a=i*Math.sin(2*d),e=(c=F(Math.round(M?i-t:s+t),Math.round(P?a:w-a)),s=i*Math.sin(d),D._c2.call(g,r.corner)),t=Math.sqrt(Math.pow(e.x-r.x,2)+Math.pow(e.y-r.y,2));return l=t<v?t/v:1,b.opts.frontGradient&&(h=100<s?(s-100)/s:0,o=F(s*Math.sin(k-d)/w*100,s*Math.cos(k-d)/v*100),P&&(o.y=100-o.y),M)&&(o.x=100-o.x),D._backGradient.call(g)&&(p=F(s*Math.sin(d)/v*100,s*Math.cos(d)/w*100),M||(p.x=100-p.x),P||(p.y=100-p.y)),u.x=Math.round(u.x),u.y=Math.round(u.y),!0};switch(r.corner){case"tl":r.x=Math.max(r.x,1),_(),t(u,[1,0,0,1],[100,0],n),b.fpage.transform(O(-w,-v,x)+j(90-2*n),"100% 100%"),a.transform(j(90)+O(0,-w,x),"0% 0%");break;case"tr":r.x=Math.min(r.x,v-1),_(),t(F(-u.x,u.y),[0,0,0,1],[0,0],-n),b.fpage.transform(O(0,-v,x)+j(2*n-90),"0% 100%"),a.transform(j(270)+O(-v,0,x),"0% 0%");break;case"bl":r.x=Math.max(r.x,1),_(),t(F(u.x,-u.y),[1,1,0,0],[100,100],-n),b.fpage.transform(O(-w,0,x)+j(2*n-90),"100% 0%"),a.transform(j(270)+O(-v,0,x),"0% 0%");break;case"br":r.x=Math.min(r.x,v-1),_(),t(F(-u.x,-u.y),[0,1,1,0],[0,100],n),b.fpage.transform(j(90-2*n),"0% 0%"),a.transform(j(90)+O(0,-w,x),"0% 0%")}b.point=r},_moveFoldingPage:function(t){var a=this.data().f,e=D._foldingPage.call(this);e&&(t?a.fpage.children()[a.ashadow?"1":"0"]||(D.setData.call(this,{backParent:e.parent()}),a.fpage.prepend(e)):a.backParent&&a.backParent.prepend(e))},_showFoldedPage:function(a,t){var e,i=D._foldingPage.call(this),r=this.data(),s=r.f;if(!s.point||s.point.corner!=a.corner){var n=o.Event("start");if(this.trigger(n,[s.opts,a.corner]),n.isDefaultPrevented())return!1}return!!i&&(t?(e=this,n=s.point&&s.point.corner==a.corner?s.point:D._c.call(this,a.corner,1),this.animatef({from:[n.x,n.y],to:[a.x,a.y],duration:500,frame:function(t){a.x=Math.round(t[0]),a.y=Math.round(t[1]),D._fold.call(e,a)}})):(D._fold.call(this,a),r.effect&&!r.effect.turning&&this.animatef(!1)),s.fwrapper.is(":visible")||(s.fparent.show().data().flips++,D._moveFoldingPage.call(this,!0),s.fwrapper.show(),s.bshadow&&s.bshadow.show()),!0)},hide:function(){var t=this.data().f,a=D._foldingPage.call(this);return 0==--t.fparent.data().flips&&t.fparent.hide(),this.css({left:0,top:0,right:"auto",bottom:"auto"}).transform("","0% 100%"),t.wrapper.transform("","0% 100%"),t.fwrapper.hide(),t.bshadow&&t.bshadow.hide(),a.transform("","0% 0%"),this},hideFoldedPage:function(t){var a,e,i,r,s,n,o=this.data().f;o.point&&(a=this,e=o.point,i=function(){o.point=null,a.flip("hide"),a.trigger("end",[!1])},t?(r=D._c.call(this,e.corner),t="t"==e.corner.substr(0,1)?Math.min(0,e.y-r.y)/2:Math.max(0,e.y-r.y)/2,s=F(e.x,e.y+t),n=F(r.x,r.y-t),this.animatef({from:0,to:1,frame:function(t){t=p(e,s,n,r,t);e.x=t.x,e.y=t.y,D._fold.call(a,e)},complete:i,duration:800,hiding:!0})):(this.animatef(!1),i()))},turnPage:function(a){var e=this,t=this.data().f,i=(a={corner:t.corner?t.corner.corner:a||D._cAllowed.call(this)[0]},t.point||D._c.call(this,a.corner,t.opts.turn?t.opts.turn.data().opts.elevation:0)),r=D._c2.call(this,a.corner);this.trigger("flip").animatef({from:0,to:1,frame:function(t){t=p(i,i,r,r,t);a.x=t.x,a.y=t.y,D._showFoldedPage.call(e,a)},complete:function(){e.trigger("end",[!0])},duration:t.opts.duration,turning:!0}),t.corner=null},moving:function(){return"effect"in this.data()},isTurning:function(){return this.flip("moving")&&this.data().effect.turning},_eventStart:function(t){var a=this.data().f;if(!a.disabled&&!this.flip("isTurning")){if(a.corner=D._cornerActivated.call(this,t),a.corner&&D._foldingPage.call(this,a.corner))return D._moveFoldingPage.call(this,!0),this.trigger("pressed",[a.point]),!1;a.corner=null}},_eventMove:function(t){var a,e=this.data().f;e.disabled||(t=h?t.originalEvent.touches:[t],e.corner?(a=e.parent.offset(),e.corner.x=t[0].pageX-a.left,e.corner.y=t[0].pageY-a.top,D._showFoldedPage.call(this,e.corner)):!this.data().effect&&this.is(":visible")&&((a=D._cornerActivated.call(this,t[0]))?(t=D._c.call(this,a.corner,e.opts.cornerSize/2),a.x=t.x,a.y=t.y,D._showFoldedPage.call(this,a,!0)):D.hideFoldedPage.call(this,!0)))},_eventEnd:function(){var t,a=this.data().f;!a.disabled&&a.point&&(t=o.Event("released"),this.trigger(t,[a.point]),t.isDefaultPrevented()||D.hideFoldedPage.call(this,!0)),a.corner=null},disable:function(t){return D.setData.call(this,{disabled:t}),this}};o.extend(o.fn,{flip:function(t,a){return e(this,D,arguments)},turn:function(t){return e(this,v,arguments)},transform:function(t,a){var e={};return a&&(e[c+"transform-origin"]=a),e[c+"transform"]=t,this.css(e)},animatef:function(e){var i=this.data();if(i.effect&&clearInterval(i.effect.handle),e){e.to.length||(e.to=[e.to]),e.from.length||(e.from=[e.from]),e.easing||(e.easing=function(t,a,e,i,r){return i*Math.sqrt(1-(a=a/r-1)*a)+e});for(var r=[],s=e.to.length,n=this,o=e.fps||30,p=-o,t=function(){var t,a=[];for(p=Math.min(e.duration,p+o),t=0;t<s;t++)a.push(e.easing(1,p,e.from[t],r[t],e.duration));e.frame(1==s?a[0]:a),p==e.duration&&(clearInterval(i.effect.handle),delete i.effect,n.data(i),e.complete)&&e.complete()},a=0;a<s;a++)r.push(e.to[a]-e.from[a]);i.effect=e,i.effect.handle=setInterval(t,o),this.data(i),t()}else delete i.effect}}),o.isTouch=h})(jQuery);